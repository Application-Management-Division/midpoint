<!--
  ~ Copyright (C) 2010-2022 Evolveum and contributors
  ~
  ~ This work is dual-licensed under the Apache License 2.0
  ~ and European Union Public License. See LICENSE file for details.
  -->

<tag xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
    oid="00000000-0000-0000-0000-000000000710">
    <name>Focus enabled</name>
    <description>Operation that made the focus enabled</description>
    <documentation>
        This is an operation that switched the effective status of the focus from (any) disabled state
        to (any) enabled state.
    </documentation>
    <policyRule>
        <name>focus-enabled</name>
        <policyConstraints>
            <modification>
                <operation>modify</operation>
            </modification>
            <transition>
                <name>$focus-enabled</name>
                <stateBefore>false</stateBefore>
                <stateAfter>true</stateAfter>
                <constraints>
                    <objectState>
                        <expression>
                            <script>
                                <code>midpoint.isEffectivelyEnabled(focus)</code>
                            </script>
                            <!-- Too wordy, too slow ("focus" value cloning during expression evaluation) -->
                            <!--<function>-->
                            <!--    <libraryRef oid="00000000-0000-0000-0000-000000001005"/>-->
                            <!--    <name>isEffectivelyEnabled</name>-->
                            <!--    <parameter>-->
                            <!--        <name>focus</name>-->
                            <!--        <expression>-->
                            <!--            <path>$focus</path>-->
                            <!--        </expression>-->
                            <!--    </parameter>-->
                            <!--</function>-->
                        </expression>
                    </objectState>
                </constraints>
            </transition>
        </policyConstraints>
        <focusSelector>
            <type>FocusType</type>
        </focusSelector>
    </policyRule>
</tag>
