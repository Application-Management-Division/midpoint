<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (C) 2010-2021 Evolveum and contributors
  ~
  ~ This work is dual-licensed under the Apache License 2.0
  ~ and European Union Public License. See LICENSE file for details.
  -->

<!--
Tests for new repository can be run with this command:
mvn integration-test -P sqale -pl model/model-intest/
-->
<!DOCTYPE suite SYSTEM "https://testng.org/testng-1.0.dtd">
<suite name="integration" parallel="false">
    <listeners>
        <listener class-name="com.evolveum.midpoint.tools.testng.AlphabeticalMethodInterceptor"/>
    </listeners>
    <!-- TODO were in unit tests - but why?
    <test name="Security" preserve-order="true" parallel="false" verbose="10">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.security.TestSecurityPrincipal"/>
            <class name="com.evolveum.midpoint.model.intest.security.TestSecurityBasic"/>
            <class name="com.evolveum.midpoint.model.intest.security.TestSecurityMedium"/>
            <class name="com.evolveum.midpoint.model.intest.security.TestSecurityAdvanced"/>
            <class name="com.evolveum.midpoint.model.intest.security.TestSecurityMultitenant"/>
        </classes>
    </test>
    -->
    <test name="Model Integration" preserve-order="true" parallel="false" verbose="10">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.TestModelServiceContract"/>
            <!--
            TODO: subclass of the above, but more is failing, probably because of missing RAW support?
            <class name="com.evolveum.midpoint.model.intest.TestModelServiceContractCaching"/>
            -->
            <class name="com.evolveum.midpoint.model.intest.TestModelCrudService"/>
            <class name="com.evolveum.midpoint.model.intest.TestPreviewChanges"/>
            <class name="com.evolveum.midpoint.model.intest.multi.TestMultiResource"/>
            <class name="com.evolveum.midpoint.model.intest.multi.TestMultiAccount"/>
            <class name="com.evolveum.midpoint.model.intest.multi.TestMultiConnectorResources"/>
            <class name="com.evolveum.midpoint.model.intest.TestUserTemplate"/>
            <class name="com.evolveum.midpoint.model.intest.TestUserTemplateWithRanges"/>
            <class name="com.evolveum.midpoint.model.intest.orgstruct.TestOrgStruct"/>
            <class name="com.evolveum.midpoint.model.intest.orgstruct.TestOrgStructMeta"/>
            <class name="com.evolveum.midpoint.model.intest.orgstruct.TestOrgStructCaribbean"/>
            <class name="com.evolveum.midpoint.model.intest.TestSchemalessResource"/>
            <class name="com.evolveum.midpoint.model.intest.TestActivation"/>
            <class name="com.evolveum.midpoint.model.intest.TestConnectorDummyFake"/>
            <class name="com.evolveum.midpoint.model.intest.TestStrangeCases"/>
            <class name="com.evolveum.midpoint.model.intest.TestResources"/>
            <class name="com.evolveum.midpoint.model.intest.mapping.TestMapping"/>
            <class name="com.evolveum.midpoint.model.intest.mapping.TestMappingInbound"/>
            <class name="com.evolveum.midpoint.model.intest.mapping.TestMappingAutoInbound"/>
            <class name="com.evolveum.midpoint.model.intest.mapping.TestMappingChaining"/>
            <class name="com.evolveum.midpoint.model.intest.mapping.TestMappingAdvanced"/>
            <class name="com.evolveum.midpoint.model.intest.TestInbounds"/>
            <class name="com.evolveum.midpoint.model.intest.TestVolatility"/>
            <!-- TODO fails on skip counter assert
            <class name="com.evolveum.midpoint.model.intest.TestTriggerTask"/>
            -->
            <class name="com.evolveum.midpoint.model.intest.TestOptimizingTriggerCreator"/>
            <class name="com.evolveum.midpoint.model.intest.TestIteration"/>
            <class name="com.evolveum.midpoint.model.intest.TestTolerantAttributes"/>
            <class name="com.evolveum.midpoint.model.intest.TestScriptHooks"/>
            <!-- TODO fails with SystemException: Expected that <identifiers> will be ResourceAttributeContainer but it is class com.evolveum.midpoint.prism.impl.PrismContainerImpl
            <class name="com.evolveum.midpoint.model.intest.TestEntitlements"/>
            -->
            <class name="com.evolveum.midpoint.model.intest.TestCaseIgnore"/>
            <class name="com.evolveum.midpoint.model.intest.TestIntent"/>
            <class name="com.evolveum.midpoint.model.intest.gensync.TestAssociationInbound"/> <!-- missing from original suite, why? -->
            <!-- TODO many "row is not incomplete in lookupTable" assertion errors
            <class name="com.evolveum.midpoint.model.intest.gensync.TestEditSchema"/>
            -->
            <!-- TODO test210 fails with: Unknown compile time class of container value of 'riskVector'.
            <class name="com.evolveum.midpoint.model.intest.gensync.TestRoleEntitlement"/>
            -->
            <class name="com.evolveum.midpoint.model.intest.TestConsistencySimple"/>
            <class name="com.evolveum.midpoint.model.intest.TestConnectorMultiInstance"/>
            <class name="com.evolveum.midpoint.model.intest.TestMerge"/>
            <!-- TODO needs working audit impl.
            <class name="com.evolveum.midpoint.model.intest.TestAudit"/>
            -->
            <!-- TODO test800/804 fail on validity scanner (type of search problem I guess)
            <class name="com.evolveum.midpoint.model.intest.TestDeputy"/>
            TODO: different kind of wrong query: Missing item mapping for 'roleType' in mapping QAssignmentHolderMapping
            <class name="com.evolveum.midpoint.model.intest.rbac.TestRbac"/>
            -->
            <class name="com.evolveum.midpoint.model.intest.rbac.TestSegregationOfDuties"/>
            <!-- TODO Missing item mapping for 'roleType' in mapping QAssignmentHolderMapping
            <class name="com.evolveum.midpoint.model.intest.rbac.TestRbacLightInitialProjection"/>
            <class name="com.evolveum.midpoint.model.intest.rbac.TestRbacNoInbounds"/>
            -->
            <class name="com.evolveum.midpoint.model.intest.rbac.TestAssignmentValidity"/>
            <class name="com.evolveum.midpoint.model.intest.rbac.TestMetaMeta"/>
            <class name="com.evolveum.midpoint.model.intest.rbac.TestAutoassign"/>
            <class name="com.evolveum.midpoint.model.intest.TestRaceConditions"/>
            <class name="com.evolveum.midpoint.model.intest.TestNotifications"/>
            <class name="com.evolveum.midpoint.model.intest.persona.TestPersona"/>
            <class name="com.evolveum.midpoint.model.intest.persona.TestPersonaPassword"/>
            <class name="com.evolveum.midpoint.model.intest.TestLifecycle"/>
            <class name="com.evolveum.midpoint.model.intest.archetypes.TestArchetypes"/>
            <class name="com.evolveum.midpoint.model.intest.archetypes.TestCollections"/>
            <!--
            <class name="com.evolveum.midpoint.model.intest.archetypes.TestArchetypeInheritance"/>
            <class name="com.evolveum.midpoint.model.intest.misc.TestMisc"/>
            <class name="com.evolveum.midpoint.model.intest.misc.TestTracing"/>
            <class name="com.evolveum.midpoint.model.intest.misc.TestUuidNonUniqueName"/>
            <class name="com.evolveum.midpoint.model.intest.misc.TestMigration"/>
            <class name="com.evolveum.midpoint.model.intest.TestFunctions"/>
            <class name="com.evolveum.midpoint.model.intest.TestLinkedObjects"/>
            <class name="com.evolveum.midpoint.model.intest.TestMemberRecompute"/>
            -->
        </classes>
    </test>
    <test name="Synchronization" preserve-order="true" parallel="false" verbose="10">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.sync.TestSyncStoryUsingLiveSync"/>
            <class name="com.evolveum.midpoint.model.intest.sync.TestSyncStoryUsingReconciliation"/>
            <class name="com.evolveum.midpoint.model.intest.sync.TestSyncStoryUsingReconciliationMultithreaded"/>
            <!-- TODO test130: Unknown definition type 'PCD:{.../common/common-3}modelExecuteOptions {.../common/common-3}ModelExecuteOptionsType[0,-1],RAM', can't say if 'modelExecuteOptions' is indexed or not.
            <class name="com.evolveum.midpoint.model.intest.sync.TestRecomputeTask"/>
            -->
            <class name="com.evolveum.midpoint.model.intest.sync.TestImportRecon"/>
            <class name="com.evolveum.midpoint.model.intest.sync.TestImportReconAuthorizations"/>
            <!--
            <class name="com.evolveum.midpoint.model.intest.sync.TestValidityRecomputeTask"/>
            <class name="com.evolveum.midpoint.model.intest.sync.TestInboundLiveSyncTask"/>
            <class name="com.evolveum.midpoint.model.intest.sync.TestInboundReconTask"/>
            <class name="com.evolveum.midpoint.model.intest.sync.TestUuid"/>
            <class name="com.evolveum.midpoint.model.intest.sync.TestObjTemplateLiveSyncTask"/>
            <class name="com.evolveum.midpoint.model.intest.tasks.TestLiveSyncTask"/>
            <class name="com.evolveum.midpoint.model.intest.tasks.TestLiveSyncTaskMultithreaded"/>
            <class name="com.evolveum.midpoint.model.intest.tasks.TestLiveSyncTaskLegacy"/>
            <class name="com.evolveum.midpoint.model.intest.tasks.TestLiveSyncTaskLegacyMultithreaded"/>
            <class name="com.evolveum.midpoint.model.intest.tasks.TestTaskReporting"/>
            <class name="com.evolveum.midpoint.model.intest.tasks.TestProgressReporting"/>
        </classes>
    </test>
    <test name="Async updates" preserve-order="true" parallel="false" verbose="10">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.async.TestNotifyChange"/>
            <class name="com.evolveum.midpoint.model.intest.async.TestAsyncUpdateUcf"/>
            <class name="com.evolveum.midpoint.model.intest.async.TestAsyncUpdateGrouperJson"/>
        </classes>
    </test>
    <test name="Importer" preserve-order="true" parallel="false" verbose="10">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.importer.XmlImportTest"/>
            <class name="com.evolveum.midpoint.model.intest.importer.JsonImportTest"/>
            <class name="com.evolveum.midpoint.model.intest.importer.YamlImportTest"/>
        </classes>
    </test>
    <test name="Scripting" preserve-order="true" parallel="false" verbose="10" enabled="true">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.scripting.TestScriptingBasicNew"/>
            <class name="com.evolveum.midpoint.model.intest.scripting.TestScriptingBasicLegacy"/>
        </classes>
    </test>
    <test name="Password" preserve-order="true" parallel="false" verbose="10" enabled="true">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.password.TestPasswordDefault"/>
            <class name="com.evolveum.midpoint.model.intest.password.TestPasswordDefaultHashing"/>
        </classes>
    </test>
    <test name="Metadata" parallel="false" verbose="10" enabled="true">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.TestValueMetadata"/>
        </classes>
    </test>
    &lt;!&ndash;
        Some tests moved to the end of suite, because they change logging configuration.
        TODO: Logging configuration should be refreshed from file during spring context reloading.
    &ndash;&gt;
    <test name="Model Integration 2" preserve-order="true" parallel="false" verbose="10">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.TestLoggingConfiguration"/>
            <class name="com.evolveum.midpoint.model.intest.negative.TestBrokenResources"/>
            <class name="com.evolveum.midpoint.model.intest.negative.TestAssignmentErrors"/>
        </classes>
    </test>
    <test name="Manual" preserve-order="true" parallel="false" verbose="10">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.manual.TestManual"/>
            <class name="com.evolveum.midpoint.model.intest.manual.TestManualCapabilities"/>
            <class name="com.evolveum.midpoint.model.intest.manual.TestSemiManual"/>
            <class name="com.evolveum.midpoint.model.intest.manual.TestSemiManualDisable"/>
            <class name="com.evolveum.midpoint.model.intest.manual.TestManualGrouping"/>
            <class name="com.evolveum.midpoint.model.intest.manual.TestSemiManualGrouping"/>
            <class name="com.evolveum.midpoint.model.intest.manual.TestSemiManualGroupingProposed"/>
            <class name="com.evolveum.midpoint.model.intest.manual.TestDummyItsmIntegration"/>
        </classes>
    </test>
    Tests from testng-db-specific.xml
    <test name="Synchronization" preserve-order="true" parallel="false" verbose="10">
        <classes>
            <class name="com.evolveum.midpoint.model.intest.sync.TestSyncStoryUsingReconciliationPartitioned"/>
            <class name="com.evolveum.midpoint.model.intest.sync.TestSyncStoryUsingReconciliationMultiNode"/>
    -->
        </classes>
    </test>
</suite>
